package dev.sora.relay.cheat.module.impl.combat

import com.nukkitx.protocol.bedrock.data.inventory.TransactionType
import com.nukkitx.protocol.bedrock.packet.InventoryTransactionPacket
import dev.sora.relay.cheat.module.CheatModule
import dev.sora.relay.cheat.value.IntValue
import dev.sora.relay.game.event.EventPacketOutbound
import dev.sora.relay.game.event.Listen

class ModuleComboOneHitExploit : CheatModule("ComboOneHit","爆发连击") {

    private val amountValue = IntValue("Amount", 10, 1, 100)
    override fun onEnable() {
        super.onEnable()
        chat("ComboOneHit不绕过花雨庭")
    }
    @Listen
    fun onPacketOutbound(event: EventPacketOutbound) {
        val packet = event.packet

        if (packet is InventoryTransactionPacket && packet.transactionType == TransactionType.ITEM_USE_ON_ENTITY) {
            values="Amount: "+amountValue.get()
            val netSession = event.session.netSession
            repeat(amountValue.get()) {
                netSession.outboundPacket(packet)
            }
        }
    }
}